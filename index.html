<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XP Deus II V5 - Precision Expert Tool</title>
    <style>
        /* --- DESIGN SYSTEM TACTIQUE --- */
        :root {
            --bg-body: #121418;
            --bg-panel: #1b2028;
            --bg-input: #0f1114;
            
            --accent-gold: #d4af37; /* Or Tactique */
            --accent-blue: #5c8bc0; /* Bleu Acier */
            --text-main: #e0e6ed;
            --text-dim: #94a3b8;
            
            --border-light: #2d333d;
            --border-active: #d4af37;
            
            --success: #66bb6a;
            --warning: #ffa726;
            --danger: #ef5350;
            --info: #29b6f6;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            line-height: 1.6;
            min-height: 100vh;
            font-size: 15px;
        }

        /* --- HEADER --- */
        header {
            background: linear-gradient(180deg, #1f242d 0%, #121418 100%);
            padding: 25px 20px;
            border-bottom: 2px solid var(--accent-gold);
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }

        header h1 {
            color: var(--accent-gold);
            font-size: 1.8rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 5px;
        }

        header p { color: var(--text-dim); font-size: 0.9rem; }

        /* --- NAVIGATION --- */
        .nav-container {
            background: var(--bg-panel);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-light);
            padding: 0 10px;
            overflow-x: auto;
            white-space: nowrap;
            display: flex;
            justify-content: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .nav-btn {
            background: none;
            border: none;
            color: var(--text-dim);
            padding: 15px 20px;
            cursor: pointer;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
        }

        .nav-btn:hover { color: var(--text-main); background: rgba(255,255,255,0.02); }
        .nav-btn.active { color: var(--accent-gold); border-bottom-color: var(--accent-gold); }

        /* --- CONTENT --- */
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px 60px 20px; }
        .tab-content { display: none; animation: fadeEffect 0.3s; }
        .tab-content.active { display: block; }
        @keyframes fadeEffect { from {opacity: 0; transform: translateY(5px);} to {opacity: 1; transform: translateY(0);} }

        /* --- CARDS & PANELS --- */
        .card {
            background: var(--bg-panel);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            position: relative;
        }

        .card h2 {
            color: var(--accent-blue);
            font-size: 1.2rem;
            text-transform: uppercase;
            margin-bottom: 20px;
            border-left: 3px solid var(--accent-gold);
            padding-left: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }

        /* --- FORMS --- */
        label { display: block; color: var(--text-dim); margin-bottom: 8px; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; }
        
        select, input[type="text"], input[type="number"], textarea {
            width: 100%;
            background: var(--bg-input);
            border: 1px solid var(--border-light);
            color: var(--text-main);
            padding: 12px;
            border-radius: 4px;
            font-size: 0.95rem;
            font-family: inherit;
        }
        
        select:focus, input:focus, textarea:focus { outline: none; border-color: var(--accent-gold); }

        /* --- BUTTONS --- */
        .btn {
            padding: 10px 20px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.85rem;
            transition: 0.2s;
        }
        .btn-gold { background: var(--accent-gold); color: #121418; }
        .btn-gold:hover { background: #bfa030; }
        .btn-outline { background: transparent; border: 1px solid var(--border-light); color: var(--text-dim); }
        .btn-outline:hover { border-color: var(--text-main); color: var(--text-main); }
        .btn-danger { background: rgba(239, 83, 80, 0.2); color: var(--danger); border: 1px solid var(--danger); }
        .btn-danger:hover { background: var(--danger); color: white; }

        /* --- SLIDERS --- */
        .slider-container { margin-bottom: 25px; position: relative; }
        .slider-header { display: flex; justify-content: space-between; margin-bottom: 5px; }
        .slider-val { color: var(--accent-gold); font-weight: bold; font-family: monospace; font-size: 1.1rem; }
        
        input[type="range"] {
            -webkit-appearance: none; width: 100%; height: 6px; background: var(--bg-input);
            border-radius: 3px; outline: none; border: 1px solid var(--border-light);
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%;
            background: var(--accent-gold); cursor: pointer; border: 2px solid var(--bg-body);
            transition: transform 0.1s;
        }
        input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.2); }

        .param-feedback {
            font-size: 0.8rem;
            color: var(--text-dim);
            margin-top: 5px;
            font-style: italic;
            border-left: 2px solid var(--border-light);
            padding-left: 8px;
            transition: color 0.3s;
        }
        .feedback-warn { color: var(--warning); border-color: var(--warning); }
        .feedback-good { color: var(--success); border-color: var(--success); }

        /* --- RESULT BOXES --- */
        .result-box {
            background: rgba(212, 175, 55, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 6px;
            padding: 20px;
            margin-top: 20px;
        }

        /* --- STICKY PANEL --- */
        .sticky-panel {
            position: -webkit-sticky; /* Pour Safari */
            position: sticky;
            top: 54px; 
            z-index: 95;
            background: var(--bg-panel);
            border: 1px solid var(--accent-gold);
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            margin-bottom: 30px;
        }

        .info-tag {
            display: inline-block;
            background: var(--bg-input);
            border: 1px solid var(--border-light);
            padding: 4px 10px;
            font-size: 0.8rem;
            color: var(--text-dim);
            border-radius: 4px;
            margin-right: 5px;
            margin-bottom: 5px;
        }

        /* --- ALERTS --- */
        .alert { padding: 12px; border-radius: 4px; margin: 10px 0; font-size: 0.9rem; border-left: 3px solid; }
        .alert-info { background: rgba(92, 139, 192, 0.1); border-color: var(--accent-blue); }
        .alert-expert { background: rgba(212, 175, 55, 0.1); border-color: var(--accent-gold); color: #e8d084; }
        .alert-warn { background: rgba(255, 167, 38, 0.1); border-color: var(--warning); }

        /* --- PERFORMANCE BARS & LABELS --- */
        .perf-bar-container { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
        
        .perf-label-group {
            display: flex;
            flex-direction: column;
            width: 140px; 
            text-align: right;
            justify-content: center;
        }
        .perf-title { font-size: 0.75rem; font-weight: bold; color: var(--text-main); text-transform: uppercase; }
        .perf-question { font-size: 0.6rem; color: var(--text-dim); font-style: italic; line-height: 1.1; margin-top: 1px; }

        .perf-track-wrapper { flex-grow: 1; display: flex; align-items: center; gap: 6px; }
        .perf-track { flex-grow: 1; height: 8px; background: var(--bg-input); border-radius: 4px; overflow: hidden; position: relative; }
        .perf-fill { height: 100%; transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        
        .range-label { font-size: 0.65rem; color: var(--text-dim); white-space: nowrap; min-width: 45px; }
        .range-label.min { text-align: right; }
        .range-label.max { text-align: left; }

        .fill-depth { background: var(--accent-blue); }
        .fill-sep { background: var(--warning); }
        .fill-fine { background: var(--success); } 
        .fill-id { background: var(--info); } 
        .fill-mask { background: var(--danger); }

        /* --- TERRAIN CARDS --- */
        .terrain-card {
            background: var(--bg-panel); border: 1px solid var(--border-light); border-radius: 8px;
            padding: 20px; cursor: pointer; transition: all 0.2s;
        }
        .terrain-card:hover { border-color: var(--accent-gold); transform: translateY(-2px); }
        .terrain-card h3 { color: var(--accent-gold); font-size: 1.1rem; margin-bottom: 5px; }

        /* --- ID VISUALIZER --- */
        .id-scale {
            display: flex; height: 30px; border-radius: 4px; overflow: hidden; margin-top: 10px; font-size: 0.75rem; color: #000; font-weight: bold; text-align: center; line-height: 30px;
        }
        .id-zone { height: 100%; transition: width 0.3s; }

        /* --- LOGBOOK & SAVED --- */
        .saved-item {
            background: var(--bg-input);
            border: 1px solid var(--border-light);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .saved-item-content h4 { color: var(--text-main); font-size: 1rem; margin-bottom: 4px; }
        .saved-item-content p { color: var(--text-dim); font-size: 0.85rem; margin: 0; }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            .nav-container { justify-content: flex-start; }
            header h1 { font-size: 1.4rem; }
            .sticky-panel { top: 50px; margin-left: -15px; margin-right: -15px; border-radius: 0; }
            .perf-label-group { width: 90px; } /* Compact on mobile */
            .perf-question { display: none; } /* Hide question on very small screens */
            @media (min-width: 380px) { .perf-question { display: block; } .perf-label-group { width: 130px; } }
        }
    </style>
</head>
<body>

    <header>
        <h1>XP Deus II V5</h1>
        <p>CONSOLE EXPERT PRO | ANALYSE TACTIQUE</p>
    </header>

    <div class="nav-container">
        <button class="nav-btn active" onclick="setTab('wizard')">Assistant</button>
        <button class="nav-btn" onclick="setTab('terrains')">Terrains</button>
        <button class="nav-btn" onclick="setTab('params')">Simulateur PRO</button>
        <button class="nav-btn" onclick="setTab('expert')">Mode Expert V4</button>
        <button class="nav-btn" onclick="setTab('profiles')">üíæ Profils</button>
        <button class="nav-btn" onclick="setTab('tools')">üÜî Outils</button>
        <button class="nav-btn" onclick="setTab('faq')">FAQ</button>
    </div>

    <div class="container">

        <!-- TAB 1: ASSISTANT -->
        <div id="wizard" class="tab-content active">
            <div class="card">
                <h2>üéØ Assistant Tactique Intelligent</h2>
                <div class="grid-2">
                    <div>
                        <label>Terrain</label>
                        <select id="wiz-terrain" onchange="runWizard()">
                            <option value="">-- S√©lectionner le type de sol --</option>
                            <option value="prairie">üåæ Prairie / Champ propre</option>
                            <option value="min√©ralis√©">üî¥ Sol min√©ralis√© (Argile, rouge)</option>
                            <option value="pollu√©">üî© Terrain tr√®s pollu√© (Ferraille)</option>
                            <option value="plage">üèñÔ∏è Plage (Sable sec/humide)</option>
                            <option value="eau">üíß Eau douce</option>
                        </select>
                    </div>
                    <div>
                        <label>Objectif</label>
                        <select id="wiz-obj" onchange="runWizard()">
                            <option value="">-- S√©lectionner la cible --</option>
                            <option value="monnaies">üí∞ Monnaies Anciennes</option>
                            <option value="or">‚ú® Or & Bijoux (Petites cibles)</option>
                            <option value="reliques">üèõÔ∏è Reliques & Militaria</option>
                            <option value="profond">üîç Grosses Masses Profondes</option>
                            <option value="tout">üéØ Polyvalent (Tout venant)</option>
                        </select>
                    </div>
                </div>
                <div id="wiz-result"></div>
            </div>
        </div>

        <!-- TAB 2: TERRAINS -->
        <div id="terrains" class="tab-content">
            <div class="card">
                <h2>üåç Encyclop√©die des Terrains</h2>
                <p style="color:var(--text-dim); margin-bottom:20px;">Cliquez sur une carte pour voir la fiche technique compl√®te.</p>
                <div id="terrain-grid" class="grid-3"></div>
            </div>
            <div id="terrain-detail"></div>
        </div>

        <!-- TAB 3: PARAMETRES (ENRICHIS & CORRIGES) -->
        <div id="params" class="tab-content">
            <div class="card">
                <h2>‚öôÔ∏è Simulateur Interactif Complet</h2>
                <p style="color:var(--text-dim); margin-bottom:20px;">Analysez l'impact de chaque r√©glage en temps r√©el.</p>

                <!-- Indicateurs de Performance (STICKY) -->
                <div class="sticky-panel" style="background:var(--bg-panel); padding:15px; border-radius:6px; border:1px solid var(--accent-gold);">
                    <label style="margin-bottom:12px; color:var(--accent-gold); font-weight:bold; letter-spacing:1px;">üìä ANALYSE TACTIQUE (TEMPS R√âEL)</label>
                    
                    <div class="perf-bar-container">
                        <div class="perf-label-group">
                            <span class="perf-title">Puissance</span>
                            <span class="perf-question">√Ä quelle profondeur ?</span>
                        </div>
                        <div class="perf-track-wrapper">
                            <span class="range-label min">Surface</span>
                            <div class="perf-track"><div id="bar-depth" class="perf-fill fill-depth" style="width:0%"></div></div>
                            <span class="range-label max">Profond</span>
                        </div>
                    </div>

                    <div class="perf-bar-container">
                        <div class="perf-label-group">
                            <span class="perf-title">S√©paration</span>
                            <span class="perf-question">Pi√®ce au milieu de clous ?</span>
                        </div>
                        <div class="perf-track-wrapper">
                            <span class="range-label min">Lent</span>
                            <div class="perf-track"><div id="bar-sep" class="perf-fill fill-sep" style="width:0%"></div></div>
                            <span class="range-label max">Rapide</span>
                        </div>
                    </div>

                    <div class="perf-bar-container">
                        <div class="perf-label-group">
                            <span class="perf-title">Sensibilit√©</span>
                            <span class="perf-question">Objets minuscules ?</span>
                        </div>
                        <div class="perf-track-wrapper">
                            <span class="range-label min">Standard</span>
                            <div class="perf-track"><div id="bar-fine" class="perf-fill fill-fine" style="width:0%"></div></div>
                            <span class="range-label max">Or Fin</span>
                        </div>
                    </div>

                    <div class="perf-bar-container">
                        <div class="perf-label-group">
                            <span class="perf-title">Discrimination</span>
                            <span class="perf-question">Or ou vieux clou ?</span>
                        </div>
                        <div class="perf-track-wrapper">
                            <span class="range-label min">Ouvert</span>
                            <div class="perf-track"><div id="bar-id" class="perf-fill fill-id" style="width:0%"></div></div>
                            <span class="range-label max">Strict</span>
                        </div>
                    </div>

                     <div class="perf-bar-container">
                        <div class="perf-label-group">
                            <span class="perf-title" style="color:var(--danger)">Risque Masquage</span>
                            <span class="perf-question">Cibles manqu√©es ?</span>
                        </div>
                        <div class="perf-track-wrapper">
                            <span class="range-label min">Faible</span>
                            <div class="perf-track"><div id="bar-mask" class="perf-fill fill-mask" style="width:0%"></div></div>
                            <span class="range-label max" style="color:var(--danger)">Critique</span>
                        </div>
                    </div>
                </div>
                
                <div class="grid-2" style="margin-top: 20px;">
                    <div>
                        <h4 style="color:var(--accent-blue); margin-bottom:15px; border-bottom:1px solid var(--border-light);">Puissance & Vitesse</h4>
                        <div class="slider-container">
                            <div class="slider-header"><label>Sensibilit√©</label><span id="val-sens" class="slider-val">93</span></div>
                            <input type="range" id="rng-sens" min="70" max="99" value="93" oninput="updateSim()">
                            <div id="feed-sens" class="param-feedback">Zone optimale pour la plupart des terrains.</div>
                        </div>
                        <div class="slider-container">
                            <div class="slider-header"><label>R√©activit√©</label><span id="val-reac" class="slider-val">2.0</span></div>
                            <input type="range" id="rng-reac" min="0" max="5" step="0.5" value="2" oninput="updateSim()">
                            <div id="feed-reac" class="param-feedback">Vitesse standard. Bon compromis.</div>
                        </div>
                        
                        <h4 style="color:var(--accent-blue); margin-top:25px; margin-bottom:15px; border-bottom:1px solid var(--border-light);">Filtres, Rejets & Encoches</h4>
                        <div class="slider-container">
                            <div class="slider-header"><label>Discrimination</label><span id="val-disc" class="slider-val">10</span></div>
                            <input type="range" id="rng-disc" min="-6" max="40" value="10" oninput="updateSim()">
                            <div id="feed-disc" class="param-feedback">Rejet classique des ferreux.</div>
                        </div>
                        <div class="slider-container">
                            <div class="slider-header"><label>Silencieux (Silencer)</label><span id="val-sil" class="slider-val">1</span></div>
                            <input type="range" id="rng-sil" min="0" max="5" value="1" oninput="updateSim()">
                            <div id="feed-sil" class="param-feedback">Standard. Filtre peu de craquements.</div>
                        </div>
                         <div class="slider-container">
                            <div class="slider-header"><label>B.Caps (Rejet Capsules)</label><span id="val-bcaps" class="slider-val">0</span></div>
                            <input type="range" id="rng-bcaps" min="0" max="5" value="0" oninput="updateSim()">
                            <div id="feed-bcaps" class="param-feedback">Filtre d√©sactiv√©.</div>
                        </div>
                        <div class="slider-container">
                            <div class="slider-header"><label>Notch (Encoche)</label><span id="val-notch" class="slider-val">OFF</span></div>
                            <input type="range" id="rng-notch" min="0" max="60" value="0" oninput="updateSim()">
                            <div id="feed-notch" class="param-feedback">Aucune fr√©quence rejet√©e sp√©cifiquement.</div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 style="color:var(--accent-blue); margin-bottom:15px; border-bottom:1px solid var(--border-light);">Audio & Nuances</h4>
                        <div class="slider-container">
                            <div class="slider-header"><label>R√©ponse Audio</label><span id="val-resp" class="slider-val">4</span></div>
                            <input type="range" id="rng-resp" min="0" max="7" value="4" oninput="updateSim()">
                            <div id="feed-resp" class="param-feedback">Standard. Les cibles profondes sonnent un peu plus faible.</div>
                        </div>
                        <div class="slider-container">
                            <div class="slider-header"><label>Volume Fer</label><span id="val-iron" class="slider-val">3</span></div>
                            <input type="range" id="rng-iron" min="0" max="5" value="3" oninput="updateSim()">
                             <div id="feed-iron" class="param-feedback">Audio ON. Vous entendez le fer en grave.</div>
                        </div>

                         <label style="margin-top:20px;">Type Audio</label>
                        <select id="sel-audio" onchange="updateSim()" style="margin-bottom:20px;">
                            <option value="Pitch">üîä Pitch (Classique & Percutant)</option>
                            <option value="Square">üìä Square (Num√©rique/Net)</option>
                            <option value="Morphing">üåä Morphing (V4 Profondeur)</option>
                            <option value="2-Tones">üéµ 2-Tons (S√©paration)</option>
                            <option value="FullTones">üéπ Full Tones (Nuances riches)</option>
                        </select>
                        
                    </div>
                </div>

                <div id="sim-analysis" class="result-box"></div>
            </div>
        </div>

        <!-- TAB 4: EXPERT -->
        <div id="expert" class="tab-content">
            <div class="card">
                <h2>üî• Mode Expert : Multi-Processing V4</h2>
                <p style="margin-bottom:20px; color:var(--text-dim)">Le V4 traite deux signaux. Ajustez l'√©cart pour maximiser la couverture.</p>

                <div class="grid-2">
                    <div style="border:1px solid var(--accent-blue); padding:20px; border-radius:6px; background:rgba(92, 139, 192, 0.05);">
                        <h3 style="color:var(--accent-blue); text-transform:uppercase; font-size:1rem; margin-bottom:15px;">Voie 1 : Profondeur (Low)</h3>
                        <div class="slider-container">
                            <div class="slider-header"><label>R√©activit√© V1</label><span id="val-v1-reac" class="slider-val">1.0</span></div>
                            <input type="range" id="rng-v1-reac" min="0" max="2.5" step="0.5" value="1" oninput="updateExpert()">
                            <div id="feed-v1-reac" class="param-feedback">P√©n√©tration maximale.</div>
                        </div>
                        <div class="slider-container">
                            <div class="slider-header"><label>Sensibilit√© V1</label><span id="val-v1-sens" class="slider-val">95</span></div>
                            <input type="range" id="rng-v1-sens" min="80" max="99" value="95" oninput="updateExpert()">
                            <div id="feed-v1-sens" class="param-feedback">Haute puissance.</div>
                        </div>
                    </div>

                    <div style="border:1px solid var(--warning); padding:20px; border-radius:6px; background:rgba(255, 167, 38, 0.05);">
                        <h3 style="color:var(--warning); text-transform:uppercase; font-size:1rem; margin-bottom:15px;">Voie 2 : S√©paration (High)</h3>
                        <div class="slider-container">
                            <div class="slider-header"><label>R√©activit√© V2</label><span id="val-v2-reac" class="slider-val">3.5</span></div>
                            <input type="range" id="rng-v2-reac" min="2.5" max="5" step="0.5" value="3.5" oninput="updateExpert()">
                            <div id="feed-v2-reac" class="param-feedback">Excellente s√©paration.</div>
                        </div>
                        <div class="slider-container">
                            <div class="slider-header"><label>Sensibilit√© V2</label><span id="val-v2-sens" class="slider-val">90</span></div>
                            <input type="range" id="rng-v2-sens" min="80" max="99" value="90" oninput="updateExpert()">
                             <div id="feed-v2-sens" class="param-feedback">Stabilit√© contr√¥l√©e.</div>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-top:20px; border:1px solid var(--border-light);">
                    <h3 style="color:var(--text-dim); font-size:1rem;">Param√®tres de Sol Avanc√©s</h3>
                    <div class="grid-3" style="margin-top:15px;">
                        <div>
                            <label>Ground Stabilizer</label>
                            <select id="exp-stab" onchange="updateExpert()">
                                <option value="0">0 - OFF (Risque faux signaux)</option>
                                <option value="1">1 - L√©ger (Profondeur OK)</option>
                                <option value="2" selected>2 - Standard (Min√©ralis√©)</option>
                                <option value="3">3 - Fort (Perte or fin)</option>
                            </select>
                            <div id="feed-stab" class="param-feedback" style="margin-top:5px;">Standard.</div>
                        </div>
                        <div>
                            <label>Shift Freq (EMI)</label>
                            <select>
                                <option value="auto">AUTO (Scan permanent)</option>
                                <option value="man">Manuel</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div id="expert-feedback"></div>
            </div>
        </div>

        <!-- TAB 5: MES PROFILS (NEW) -->
        <div id="profiles" class="tab-content">
            <div class="card">
                <h2>üíæ Sauvegarder Mes Configurations</h2>
                <div class="grid-2">
                    <div>
                        <label>Nom du profil</label>
                        <input type="text" id="profile-name" placeholder="Ex: Mon Champ Pr√©f√©r√©">
                    </div>
                    <div>
                        <label>Action</label>
                        <button class="btn btn-gold" style="width:100%" onclick="saveProfile()">Enregistrer les param√®tres actuels</button>
                    </div>
                </div>
                <p style="font-size:0.8rem; color:var(--text-dim); margin-top:10px;">*Sauvegarde les valeurs actuelles des onglets Param√®tres et Expert.</p>
            </div>
            <div class="card">
                <h2>Mes Profils Enregistr√©s</h2>
                <div id="saved-profiles-list">
                    <p style="color:var(--text-dim); text-align:center;">Aucun profil sauvegard√©.</p>
                </div>
            </div>
        </div>

        <!-- TAB 6: OUTILS & ID (NEW) -->
        <div id="tools" class="tab-content">
            <div class="card">
                <h2>üÜî Guide Visuel des Indices (Target ID)</h2>
                <p style="color:var(--text-dim); margin-bottom:15px;">R√©f√©rence rapide pour identifier les cibles probables selon l'indice affich√©.</p>
                
                <div style="position:relative; margin-bottom:30px;">
                    <div class="id-scale">
                        <div class="id-zone" style="width:10%; background:#ef5350;">FER</div>
                        <div class="id-zone" style="width:20%; background:#ffa726;">OR/ALU</div>
                        <div class="id-zone" style="width:30%; background:#ffee58; color:#000;">BRONZE</div>
                        <div class="id-zone" style="width:30%; background:#66bb6a;">ARGENT</div>
                        <div class="id-zone" style="width:10%; background:#29b6f6;">GROS</div>
                    </div>
                    <div style="display:flex; justify-content:space-between; font-size:0.7rem; color:var(--text-dim); margin-top:5px;">
                        <span>0</span><span>10</span><span>30</span><span>60</span><span>90</span><span>99</span>
                    </div>
                </div>

                <div class="grid-2">
                    <ul style="font-size:0.9rem; color:var(--text-main);">
                        <li><strong style="color:#ef5350">00-09:</strong> Ferreux (Clous, fers √† cheval)</li>
                        <li><strong style="color:#ffa726">10-25:</strong> Aluminium fin, Petit Or, Petits bijoux</li>
                        <li><strong style="color:#ffee58">26-50:</strong> Nickel, Cartouches, Bronze moyen</li>
                    </ul>
                    <ul style="font-size:0.9rem; color:var(--text-main);">
                        <li><strong style="color:#66bb6a">51-85:</strong> Cuivre, Monnaies Argent, Bronze large</li>
                        <li><strong style="color:#29b6f6">86-99:</strong> Grosses masses Argent, Hot Rocks, Alu massif</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <h2>üìù Carnet de D√©couvertes</h2>
                <div class="grid-2">
                    <div>
                        <label>Trouvaille</label>
                        <input type="text" id="log-find" placeholder="Ex: Napol√©on III">
                    </div>
                    <div>
                        <label>Profondeur (cm)</label>
                        <input type="number" id="log-depth" placeholder="20">
                    </div>
                </div>
                <div style="margin-top:10px;">
                    <button class="btn btn-outline" style="width:100%" onclick="addLog()">Ajouter au journal</button>
                </div>
                
                <div id="logbook-list" style="margin-top:20px;">
                    <!-- Logs go here -->
                </div>
            </div>
        </div>

        <!-- TAB 8: FAQ -->
        <div id="faq" class="tab-content">
            <div class="card">
                <h2>‚ùì Foire Aux Questions</h2>
                <div id="faq-container"></div>
            </div>
        </div>

    </div>

    <!-- JAVASCRIPT ENGINE -->
    <script>
        // --- BASE DE DONN√âES COMPL√àTE ---
        const DATA = {
            programs: {
                general: { name: "General", desc: "Polyvalent, bon √©quilibre partout" },
                sensitive: { name: "Sensitive", desc: "Profondeur maximale, terrain propre" },
                fast: { name: "Fast", desc: "Vitesse de d√©tection √©lev√©e, ferraille" },
                gold: { name: "Gold", desc: "Or fin, petites cibles" },
                relics: { name: "Relics", desc: "Objets anciens" },
                beach: { name: "Beach", desc: "Plage, eau, sable, sel" },
                deep: { name: "Deep", desc: "Grosses masses profondes" }
            },
            objectives: {
                monnaies: { label: "Monnaies Anciennes", program: ["General", "Sensitive"], sens: "93-95", react: "1-2", discri: "8-10", audio: "Square", conseil: "Priorisez la profondeur (R√©ac basse) et une audio nette (Square) pour identifier les monnaies profondes." },
                or: { label: "Or & Bijoux", program: ["Gold"], sens: "94-97", react: "2.5-3", discri: "0-5", audio: "Morphing", conseil: "Sensibilit√© max requise. Ne discriminez pas trop (0-5) pour ne pas rater l'or fin." },
                reliques: { label: "Objets / Reliques", program: ["Relics"], sens: "89-93", react: "2.5-3.5", discri: "8-12", audio: "2-Tones", conseil: "Bon √©quilibre profondeur/s√©paration. Le 2-Tons aide √† vite trier le fer." },
                profond: { label: "Masses Profondes", program: ["Deep", "Sensitive"], sens: "95-99", react: "0-1", discri: "-6 √† 5", audio: "Morphing", conseil: "R√©activit√© 0 indispensable pour l'extr√™me profondeur. Balayage lent obligatoire." },
                tout: { label: "Polyvalent", program: ["General"], sens: "92-94", react: "2", discri: "10", audio: "Square", conseil: "Le meilleur compromis pour d√©buter une zone inconnue." }
            },
            terrains: {
                prairie: {
                    name: "üåæ Prairie / Champ Propre",
                    min: "Basse (0-10)", poll: "Faible", depth: "50-70 cm",
                    config: { sens: 95, reac: 1, disc: 8, freq: "28 kHz", stab: 0, fer: 2 },
                    experts: ["R√©activit√© 0-1 ABSOLUMENT (chaque cran = 2-3cm de profondeur)", "Sensibilit√© 95-99 possible (tester avant)", "Shift Freq AUTO si ligne √©lectrique proche"],
                    astuces: ["Balayez lentement pour laisser le temps au signal de monter."]
                },
                min√©ralis√©: {
                    name: "üî¥ Sol Min√©ralis√© (Rouge)",
                    min: "Haute (60-90)", poll: "Moyenne", depth: "30-45 cm",
                    config: { sens: 88, reac: 2.5, disc: 10, freq: "40 kHz", stab: 2, fer: 2 },
                    experts: ["Ground Stabilizer 2-3 ESSENTIEL", "Fr√©quence 40 kHz pour sortir les cibles du bruit de sol", "GRAB (pompage) r√©gulier n√©cessaire"],
                    astuces: ["Ne poussez pas la sensibilit√© au-del√† de 90."]
                },
                pollu√©: {
                    name: "üî© Terrain Pollu√© (Ferraille)",
                    min: "Moyenne", poll: "TR√àS HAUTE", depth: "25-40 cm",
                    config: { sens: 87, reac: 3, disc: 10, freq: "28 kHz", stab: 1, fer: 3 },
                    experts: ["R√©activit√© 3+ OBLIGATOIRE", "Audio 2-Tones ou Pitch pour s√©parer", "Silencer √† 1 ou 2 pour calmer le fer"],
                    astuces: ["√âcoutez les 'bavures' des signaux ferreux."]
                },
                plage: {
                    name: "üèñÔ∏è Plage (Sable)",
                    min: "Variable (Sel)", poll: "Alu/Languettes", depth: "35-50 cm",
                    config: { sens: 92, reac: 2, disc: 15, freq: "28 kHz", stab: 1, fer: 2 },
                    experts: ["Mode BEACH indispensable (soustraction sel)", "GB (Effet de sol) souvent vers 23-27 sur sable mouill√©", "Sable noir = Min√©ralisation extr√™me -> 40kHz"],
                    astuces: ["Sable mouill√© = meilleure conductivit√© que sec."]
                },
                eau: {
                    name: "üíß Eau Douce",
                    min: "Tr√®s basse", poll: "Faible", depth: "40-60 cm",
                    config: { sens: 93, reac: 2, disc: 5, freq: "14/28 kHz", stab: 0, fer: 2 },
                    experts: ["Discrimination basse (0-5) pour tout prendre", "Eau = isolant sonore, on peut monter la Sensibilit√©"],
                    astuces: ["Attention √† l'√©tanch√©it√© du bouchon gris (Antenne)."]
                }
            },
            faq: [
                {q: "Quelle sensibilit√© pour d√©buter ?", a: "Commencez √† 93. Si stable, montez √† 95. Si instable, descendez par paliers de 2 jusqu'√† 85."},
                {q: "Diff√©rence Monnaies vs Reliques ?", a: "Monnaies = cibles conductrices rondes (Audio net). Reliques = objets ferreux ou alliages (Audio baveux)."},
                {q: "Qu'est-ce que le Multi-Processing ?", a: "C'est la capacit√© du Deus II V4 √† traiter deux niveaux de r√©activit√© simultan√©ment (une voie pour le fond, une pour la surface)."},
                {q: "Mon disque clignote vite ?", a: "C'est normal en mode veille ou recherche. S'il ne clignote plus, la batterie est vide."}
            ]
        };

        // --- NAVIGATION ---
        function setTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            if(tabId === 'terrains') renderTerrains();
            if(tabId === 'faq') renderFAQ();
            if(tabId === 'params') updateSim();
            if(tabId === 'expert') updateExpert();
            if(tabId === 'profiles') renderProfiles();
            if(tabId === 'tools') renderLogs();
        }

        // --- CALCULATION ENGINE (Shared) ---
        function calculatePerformance(sens, reac, disc, iron, resp, sil, bcaps, notch, audio) {
            // 1. PUISSANCE (Depth)
            let depthScore = ((sens - 60) * 1.5) + ((5 - reac) * 12); 
            depthScore -= (sil * 4); // Silencer hurts depth significantly
            if(audio === "Morphing") depthScore += 5;
            if(disc > 10) depthScore -= (disc/5); 
            
            // 2. S√âPARATION (Reactivity)
            let sepScore = (reac * 20); 
            if(sens > 95) sepScore -= 5;
            if(audio === "Pitch" || audio === "2-Tones") sepScore += 5;
            if(sil > 2) sepScore -= 10; 

            // 3. FINESSE (Sensitivity - Tiny objects)
            let fineScore = (sens - 75) * 4; 
            if(reac >= 2.5) fineScore += 10; 
            if(disc < 0) fineScore += 10; 

            // 4. IDENTIFICATION (Discrimination - Gold vs Nail)
            let idScore = 50;
            if(audio === "FullTones") idScore += 25;
            if(audio === "Pitch") idScore += 15;
            if(audio === "Square") idScore += 10;
            if(iron > 0) idScore += 15; else idScore -= 20; 
            if(bcaps > 0) idScore += 10; 
            if(disc > 5 && disc < 20) idScore += 10; 

            // 5. MASQUAGE
            let maskScore = (sil * 15) + ((5-reac) * 10) + (bcaps * 5); 
            if(iron === 0) maskScore += 25;
            if(disc > 15) maskScore += (disc - 10);
            if(notch > 0) maskScore += 15;

            // Normalize
            const normalize = (val) => Math.max(5, Math.min(100, val));
            
            return { 
                depth: normalize(depthScore), 
                sep: normalize(sepScore), 
                fine: normalize(fineScore),
                id: normalize(idScore),
                mask: normalize(maskScore) 
            };
        }

        // --- WIZARD LIVE UPDATE LOGIC ---
        function updateWizardLive() {
            // Read Base values from inputs 
            const sens = parseInt(document.getElementById('wiz-rng-sens').value);
            const reac = parseFloat(document.getElementById('wiz-rng-reac').value);
            const disc = parseInt(document.getElementById('wiz-rng-disc').value);
            
            // Read Advanced values from inputs
            const sil = parseInt(document.getElementById('wiz-rng-sil').value);
            const iron = parseInt(document.getElementById('wiz-rng-iron').value);
            const resp = parseInt(document.getElementById('wiz-rng-resp').value);
            const bcaps = parseInt(document.getElementById('wiz-rng-bcaps').value);
            const audioType = document.getElementById('wiz-sel-audio').value; 

            // Update display values next to sliders
            document.getElementById('wiz-val-sens').textContent = sens;
            document.getElementById('wiz-val-reac').textContent = reac;
            document.getElementById('wiz-val-disc').textContent = disc;
            document.getElementById('wiz-val-sil').textContent = sil;
            document.getElementById('wiz-val-iron').textContent = iron;
            document.getElementById('wiz-val-resp').textContent = resp;
            document.getElementById('wiz-val-bcaps').textContent = bcaps;

            // Calculate Performance
            const scores = calculatePerformance(sens, reac, disc, iron, resp, sil, bcaps, 0, audioType); 

            // Update Gauges
            document.getElementById('wiz-bar-depth').style.width = scores.depth + "%";
            document.getElementById('wiz-bar-sep').style.width = scores.sep + "%";
            document.getElementById('wiz-bar-fine').style.width = scores.fine + "%";
            document.getElementById('wiz-bar-id').style.width = scores.id + "%";
            document.getElementById('wiz-bar-mask').style.width = scores.mask + "%";

            // Provide Live Advice Feedback
            const feedbackSens = getFeedback('sens', sens);
            const feedbackReac = getFeedback('reac', reac);
            const feedbackDisc = getFeedback('disc', disc);
            const feedbackSil = getFeedback('sil', sil);
            const feedbackIron = getFeedback('iron', iron);
            const feedbackResp = getFeedback('resp', resp);
            const feedbackBcaps = getFeedback('bcaps', bcaps);

            function updateFeed(id, obj) {
                const el = document.getElementById(id);
                el.textContent = obj.text;
                el.className = "param-feedback " + (obj.color === 'warn' ? 'feedback-warn' : 'feedback-good');
            }

            updateFeed('wiz-feed-sens', feedbackSens);
            updateFeed('wiz-feed-reac', feedbackReac);
            updateFeed('wiz-feed-disc', feedbackDisc);
            updateFeed('wiz-feed-sil', feedbackSil);
            updateFeed('wiz-feed-iron', feedbackIron);
            updateFeed('wiz-feed-resp', feedbackResp);
            updateFeed('wiz-feed-bcaps', feedbackBcaps);
        }

        // --- WIZARD LOGIC ---
        function runWizard() {
            const tVal = document.getElementById('wiz-terrain').value;
            const oVal = document.getElementById('wiz-obj').value;
            if(!tVal || !oVal) return;

            const tData = DATA.terrains[tVal];
            const oData = DATA.objectives[oVal];

            // 1. DERIVE SETTINGS (Automatic Logic)
            let sensVal = parseInt(oData.sens.substring(0, 2)); 
            let reacVal = parseFloat(oData.react.substring(0, 3)); 
            let discVal = parseInt(oData.discri.split('-')[0]); 
            
            // Advanced Defaults based on Context
            let silencerVal = 1; 
            if (tVal === 'pollu√©') silencerVal = 2;
            if (oVal === 'profond') silencerVal = 0;

            let ironVolVal = 3; 
            if (tVal === 'pollu√©') ironVolVal = 3;

            let audioRespVal = 4; 
            if (tVal === 'min√©ralis√©') audioRespVal = 3;
            if (oVal === 'profond') audioRespVal = 5;

            let bCapsVal = 0; 
            if (tVal === 'pollu√©' || tVal === 'plage') bCapsVal = 2;

            let audioType = oData.audio;

            // 2. GENERATE HTML
            let synergyHtml = "";
            let comboColor = "alert-info";

            if (tVal === 'pollu√©' && oVal === 'monnaies') {
                synergyHtml = "‚ö†Ô∏è <strong>D√©fi Technique :</strong> Trouver des monnaies dans la pollution est difficile.";
                comboColor = "alert-warn";
            } else if (tVal === 'min√©ralis√©' && oVal === 'or') {
                synergyHtml = "üö® <strong>Attention Or/Sol :</strong> L'or natif sonne comme le sol. Utilisez le mode GOLD FIELD.";
                comboColor = "alert-warn";
            } else if (tVal === 'plage' && oVal === 'or') {
                 synergyHtml = "‚ú® <strong>Or sur Plage :</strong> Ne discriminez pas l'alu, vous perdriez l'or.";
                 comboColor = "alert-expert";
            } else {
                 synergyHtml = "‚úÖ <strong>Configuration Standard :</strong> Pas de conflit majeur.";
            }

            let html = `
            <div class="result-box" style="border-left: 4px solid var(--accent-gold);">
                
                <!-- GAUGES SECTION IN WIZARD -->
                <div style="background:rgba(0,0,0,0.2); padding:15px; border-radius:6px; margin-bottom: 20px; border:1px solid var(--border-light);">
                    <label style="margin-bottom:10px; color:var(--text-main); font-size:0.85rem; text-transform:uppercase;">Analyse Tactique (Temps R√©el)</label>
                    <div class="perf-bar-container">
                        <div class="perf-label-group">
                            <span class="perf-title">Puissance</span>
                            <span class="perf-question">√Ä quelle profondeur ?</span>
                        </div>
                        <div class="perf-track-wrapper">
                            <span class="range-label min">Surface</span>
                            <div class="perf-track"><div id="wiz-bar-depth" class="perf-fill fill-depth" style="width:0%"></div></div>
                            <span class="range-label max">Profond</span>
                        </div>
                    </div>
                    <div class="perf-bar-container">
                        <div class="perf-label-group">
                            <span class="perf-title">S√©paration</span>
                            <span class="perf-question">Pi√®ce au milieu de clous ?</span>
                        </div>
                        <div class="perf-track-wrapper">
                            <span class="range-label min">Lent</span>
                            <div class="perf-track"><div id="wiz-bar-sep" class="perf-fill fill-sep" style="width:0%"></div></div>
                            <span class="range-label max">Rapide</span>
                        </div>
                    </div>
                    <div class="perf-bar-container">
                        <div class="perf-label-group">
                            <span class="perf-title">Sensibilit√©</span>
                            <span class="perf-question">Objets minuscules ?</span>
                        </div>
                        <div class="perf-track-wrapper">
                            <span class="range-label min">Standard</span>
                            <div class="perf-track"><div id="wiz-bar-fine" class="perf-fill fill-fine" style="width:0%"></div></div>
                            <span class="range-label max">Or Fin</span>
                        </div>
                    </div>
                    <div class="perf-bar-container">
                        <div class="perf-label-group">
                            <span class="perf-title">Discrimination</span>
                            <span class="perf-question">Or ou vieux clou ?</span>
                        </div>
                        <div class="perf-track-wrapper">
                            <span class="range-label min">Ouvert</span>
                            <div class="perf-track"><div id="wiz-bar-id" class="perf-fill fill-id" style="width:0%"></div></div>
                            <span class="range-label max">Strict</span>
                        </div>
                    </div>
                     <div class="perf-bar-container">
                        <div class="perf-label-group">
                            <span class="perf-title" style="color:var(--danger)">Risque Masquage</span>
                            <span class="perf-question">Cibles manqu√©es ?</span>
                        </div>
                        <div class="perf-track-wrapper">
                            <span class="range-label min">Faible</span>
                            <div class="perf-track"><div id="wiz-bar-mask" class="perf-fill fill-mask" style="width:0%"></div></div>
                            <span class="range-label max" style="color:var(--danger)">Critique</span>
                        </div>
                    </div>
                </div>

                <div class="grid-2">
                    <div>
                        <h4 style="color:var(--accent-blue); font-size:0.9rem; margin-bottom:5px; border-bottom:1px solid var(--border-light);">PARAM√àTRES DE BASE (INTERACTIF)</h4>
                        <div style="font-size:1.1rem; font-weight:bold; color:var(--text-main); margin-bottom:10px;">${oData.program[0]}</div>
                        
                        <div class="slider-container" style="margin-bottom:15px;">
                            <div class="slider-header"><label>Sensibilit√©</label><span id="wiz-val-sens" class="slider-val">${sensVal}</span></div>
                            <input type="range" id="wiz-rng-sens" min="60" max="99" value="${sensVal}" oninput="updateWizardLive()">
                            <div id="wiz-feed-sens" class="param-feedback"></div>
                        </div>

                        <div class="slider-container" style="margin-bottom:15px;">
                            <div class="slider-header"><label>R√©activit√©</label><span id="wiz-val-reac" class="slider-val">${reacVal}</span></div>
                            <input type="range" id="wiz-rng-reac" min="0" max="5" step="0.5" value="${reacVal}" oninput="updateWizardLive()">
                            <div id="wiz-feed-reac" class="param-feedback"></div>
                        </div>

                        <div class="slider-container" style="margin-bottom:15px;">
                            <div class="slider-header"><label>Discrimination</label><span id="wiz-val-disc" class="slider-val">${discVal}</span></div>
                            <input type="range" id="wiz-rng-disc" min="-6" max="40" value="${discVal}" oninput="updateWizardLive()">
                            <div id="wiz-feed-disc" class="param-feedback"></div>
                        </div>

                        <div style="font-size:0.85rem; color:var(--text-dim); margin-top:10px;">
                            <strong>Fr√©quence:</strong> ${tData.config.freq} <br>
                            <strong>G. Stab:</strong> ${tData.config.stab}
                        </div>
                    </div>
                    <div>
                        <h4 style="color:var(--warning); font-size:0.9rem; margin-bottom:5px; border-bottom:1px solid var(--border-light);">PARAM√àTRES AVANC√âS (INTERACTIF)</h4>
                        
                        <div class="slider-container" style="margin-bottom:15px;">
                            <div class="slider-header"><label>Silencieux</label><span id="wiz-val-sil" class="slider-val">${silencerVal}</span></div>
                            <input type="range" id="wiz-rng-sil" min="0" max="5" value="${silencerVal}" oninput="updateWizardLive()">
                            <div id="wiz-feed-sil" class="param-feedback"></div>
                        </div>

                        <div class="slider-container" style="margin-bottom:15px;">
                            <div class="slider-header"><label>Vol Fer</label><span id="wiz-val-iron" class="slider-val">${ironVolVal}</span></div>
                            <input type="range" id="wiz-rng-iron" min="0" max="5" value="${ironVolVal}" oninput="updateWizardLive()">
                            <div id="wiz-feed-iron" class="param-feedback"></div>
                        </div>

                        <div class="slider-container" style="margin-bottom:15px;">
                            <div class="slider-header"><label>R√©p. Audio</label><span id="wiz-val-resp" class="slider-val">${audioRespVal}</span></div>
                            <input type="range" id="wiz-rng-resp" min="0" max="7" value="${audioRespVal}" oninput="updateWizardLive()">
                            <div id="wiz-feed-resp" class="param-feedback"></div>
                        </div>

                        <div class="slider-container" style="margin-bottom:15px;">
                            <div class="slider-header"><label>B.Caps</label><span id="wiz-val-bcaps" class="slider-val">${bCapsVal}</span></div>
                            <input type="range" id="wiz-rng-bcaps" min="0" max="5" value="${bCapsVal}" oninput="updateWizardLive()">
                            <div id="wiz-feed-bcaps" class="param-feedback"></div>
                        </div>

                        <label style="margin-top:10px;">Audio Type</label>
                        <select id="wiz-sel-audio" onchange="updateWizardLive()" style="margin-bottom:5px;">
                            <option value="Pitch" ${audioType === 'Pitch' ? 'selected' : ''}>Pitch</option>
                            <option value="Square" ${audioType === 'Square' ? 'selected' : ''}>Square</option>
                            <option value="Morphing" ${audioType === 'Morphing' ? 'selected' : ''}>Morphing</option>
                            <option value="2-Tones" ${audioType === '2-Tones' ? 'selected' : ''}>2-Tons</option>
                        </select>
                    </div>
                </div>
                
                <div style="margin-top:15px;">
                     <div class="alert ${comboColor}" style="margin-bottom:10px;">${synergyHtml}</div>
                     <div class="alert alert-expert">üí° <strong>Conseil :</strong> ${oData.conseil}</div>
                </div>
            </div>`;
            document.getElementById('wiz-result').innerHTML = html;
            
            // Trigger calculation immediately to set bars
            setTimeout(() => updateWizardLive(), 50);
        }

        // --- TERRAINS RENDER ---
        function renderTerrains() {
            const container = document.getElementById('terrain-grid');
            if(container.innerHTML !== "") return; 

            for(const key in DATA.terrains) {
                const t = DATA.terrains[key];
                const card = document.createElement('div');
                card.className = 'terrain-card';
                card.innerHTML = `<h3>${t.name}</h3><p style="color:var(--text-dim); font-size:0.85rem;">${t.min} | ${t.depth}</p>`;
                card.onclick = () => showTerrainDetail(key);
                container.appendChild(card);
            }
        }

        function showTerrainDetail(key) {
            const t = DATA.terrains[key];
            const c = t.config;
            const html = `
            <div class="result-box" style="animation: fadeEffect 0.3s;">
                <h3 style="color:var(--accent-gold); border-bottom:1px solid var(--border-light); padding-bottom:10px; margin-bottom:15px;">${t.name} - CONFIGURATION D√âTAILL√âE</h3>
                
                <div class="grid-2">
                    <table>
                        <tr><th>R√©glage</th><th>Valeur</th></tr>
                        <tr><td>Sensibilit√©</td><td>${c.sens}</td></tr>
                        <tr><td>R√©activit√©</td><td>${c.reac}</td></tr>
                        <tr><td>Discri</td><td>${c.disc}</td></tr>
                        <tr><td>Audio</td><td>Square/Pitch</td></tr>
                    </table>
                    <table>
                        <tr><th>Tech</th><th>Valeur</th></tr>
                        <tr><td>Fr√©quence</td><td>${c.freq}</td></tr>
                        <tr><td>Stabilizer</td><td>${c.stab}</td></tr>
                        <tr><td>Vol Fer</td><td>${c.fer}</td></tr>
                        <tr><td>Notch</td><td>00-00</td></tr>
                    </table>
                </div>

                <h4 style="color:var(--accent-blue); margin-top:15px; margin-bottom:10px;">Avis des Experts XP</h4>
                <ul>
                    ${t.experts.map(e => `<li style="margin-bottom:5px; color:var(--text-main); list-style-position:inside;">${e}</li>`).join('')}
                </ul>
            </div>`;
            document.getElementById('terrain-detail').innerHTML = html;
        }

        // --- SIMULATOR LOGIC WITH ADVANCED FEEDBACK ---
        function getFeedback(type, val) {
            if(type === 'sens') {
                if(val < 85) return {text: "R√©duit drastiquement les faux signaux (sol min√©ralis√©/EMI).", color: "good"};
                if(val > 96) return {text: "Gain profondeur extr√™me, mais risque d'instabilit√© important.", color: "warn"};
                return {text: "Zone optimale. Bon √©quilibre puissance/stabilit√©.", color: "good"};
            }
            if(type === 'reac') {
                if(val <= 1) return {text: "Profondeur MAX. Balayage lent obligatoire. Masquage ferreux fort.", color: "good"};
                if(val >= 3) return {text: "Sniper. S√©pare les cibles coll√©es aux ferreux. Perte de profondeur.", color: "warn"};
                return {text: "Standard. Bon compromis tout-terrain.", color: "good"};
            }
            if(type === 'disc') {
                if(val < 0) return {text: "Tous m√©taux. Utile pour entendre le sol et les c√©ramiques.", color: "good"};
                if(val > 10) return {text: "Attention : risque de rejeter de l'or fin ou monnaies sur la tranche.", color: "warn"};
                return {text: "Rejet classique des ferreux.", color: "good"};
            }
            if(type === 'resp') {
                if(val <= 3) return {text: "Les cibles profondes sonnent faiblement. Bonne info de distance.", color: "good"};
                if(val >= 6) return {text: "Sons satur√©s. Tout sonne fort (m√™me profond). Perte de nuance.", color: "warn"};
                return {text: "Standard. Amplifie l√©g√®rement les sons lointains.", color: "good"};
            }
            if(type === 'sil') {
                if(val >= 3) return {text: "Attention : Masque fortement les bonnes cibles proches des ferreux.", color: "warn"};
                return {text: "Filtre les craquements ferreux.", color: "good"};
            }
            if(type === 'iron') {
                if(val == 0) return {text: "Silence total sur ferreux. Risque de creuser sur gros fer (sans l'entendre).", color: "warn"};
                return {text: "Audio ON. Vous entendez le fer en grave.", color: "good"};
            }
            if(type === 'bcaps') {
                if(val == 0) return {text: "Filtre d√©sactiv√©. Les capsules d'acier sonneront.", color: "good"};
                if(val >= 4) return {text: "Rejet agressif. Peut affecter certaines grosses monnaies.", color: "warn"};
                return {text: "Rejet efficace des capsules modernes.", color: "good"};
            }
             if(type === 'notch') {
                if(val == 0) return {text: "Aucune fr√©quence rejet√©e sp√©cifiquement.", color: "good"};
                return {text: `Rejet sp√©cifique de la zone ${val}-${parseInt(val)+6}.`, color: "good"};
            }
            
            // FEEDBACK MODE EXPERT (V1/V2/STAB)
             if(type === 'v1reac') {
                if(val <= 1) return {text: "Parfait pour une voie Profondeur.", color: "good"};
                return {text: "Trop √©lev√© pour une voie Profondeur. Perte de l'avantage V4.", color: "warn"};
            }
             if(type === 'v1sens') {
                if(val >= 95) return {text: "Haute puissance. Id√©al si le sol le permet.", color: "good"};
                return {text: "Un peu faible pour une voie Profondeur.", color: "good"};
            }
             if(type === 'v2reac') {
                if(val >= 3) return {text: "Excellente s√©paration dans le fer.", color: "good"};
                return {text: "Trop lent pour une voie S√©paration.", color: "warn"};
            }
             if(type === 'v2sens') {
                if(val <= 92) return {text: "Stable. √âvite la cacophonie.", color: "good"};
                return {text: "Risque de bruit excessif avec haute r√©activit√©.", color: "warn"};
            }
             if(type === 'stab') {
                if(val <= 1) return {text: "L√©ger. Pr√©serve les petites cibles.", color: "good"};
                return {text: "Fort. Stabilise le sol mais masque l'or fin.", color: "warn"};
            }
            
            return {text:"", color:""};
        }

        function updateSim() {
            const sens = parseInt(document.getElementById('rng-sens').value);
            const reac = parseFloat(document.getElementById('rng-reac').value);
            const disc = parseInt(document.getElementById('rng-disc').value);
            const iron = parseInt(document.getElementById('rng-iron').value);
            const resp = parseInt(document.getElementById('rng-resp').value);
            const sil = parseInt(document.getElementById('rng-sil').value);
            const bcaps = parseInt(document.getElementById('rng-bcaps').value);
            const notch = parseInt(document.getElementById('rng-notch').value);
            
            const audio = document.getElementById('sel-audio').value;

            // Update Values Display
            document.getElementById('val-sens').innerText = sens;
            document.getElementById('val-reac').innerText = reac;
            document.getElementById('val-disc').innerText = disc;
            document.getElementById('val-iron').innerText = iron;
            document.getElementById('val-resp').innerText = resp;
            document.getElementById('val-sil').innerText = sil;
            document.getElementById('val-bcaps').innerText = bcaps;
            document.getElementById('val-notch').innerText = notch > 0 ? notch + "-" + (notch+6) : "OFF";


            // Update Feedback Text
            const fbSens = getFeedback('sens', sens);
            const fbReac = getFeedback('reac', reac);
            const fbDisc = getFeedback('disc', disc);
            const fbResp = getFeedback('resp', resp);
            const fbSil = getFeedback('sil', sil);
            const fbIron = getFeedback('iron', iron);
            const fbBcaps = getFeedback('bcaps', bcaps);
            const fbNotch = getFeedback('notch', notch);

            function setFb(id, obj) {
                const el = document.getElementById(id);
                el.innerText = obj.text;
                el.className = "param-feedback " + (obj.color === 'warn' ? 'feedback-warn' : 'feedback-good');
            }

            setFb('feed-sens', fbSens);
            setFb('feed-reac', fbReac);
            setFb('feed-disc', fbDisc);
            setFb('feed-resp', fbResp);
            setFb('feed-sil', fbSil);
            setFb('feed-iron', fbIron);
            setFb('feed-bcaps', fbBcaps);
            setFb('feed-notch', fbNotch);

            // CALCULATE GAUGES USING SHARED ENGINE
            const scores = calculatePerformance(sens, reac, disc, iron, resp, sil, bcaps, notch, audio);

            // Render Bars
            document.getElementById('bar-depth').style.width = scores.depth + "%";
            document.getElementById('bar-sep').style.width = scores.sep + "%";
            document.getElementById('bar-fine').style.width = scores.fine + "%";
            document.getElementById('bar-id').style.width = scores.id + "%";
            document.getElementById('bar-mask').style.width = scores.mask + "%";

            // --- ANALYSE TEXTUELLE ---
            let analysis = `<h4 style="color:var(--accent-gold);">Analyse de la configuration</h4>`;
            
            // Warnings Iron Mask
            if(iron === 0) {
                 analysis += `<p class="alert alert-warn">üîá <strong>Danger "Volume Fer 0" :</strong> Vous n'entendez pas la pollution ferreuse. En terrain pollu√©, vous allez subir un masquage silencieux important. Recommand√© : Vol Fer √† 2 ou 3.</p>`;
            }

            // Warnings Audio Response
            if(resp >= 6) {
                analysis += `<p class="alert alert-warn">üîä <strong>Saturation Audio :</strong> Avec une R√©ponse Audio √† ${resp}, les cibles de surface et profondes sonnent pareil. Vous perdez la notion de distance/profondeur.</p>`;
            }

            // Mode Logic
            if(sens >= 95 && reac <= 1) {
                analysis += `<p class="alert alert-expert">üöÄ <strong>Mode Turbo Profondeur :</strong> Excellent pour terrain propre. Attention aux faux signaux sur sol min√©ralis√©.</p>`;
            } else if (reac >= 3) {
                 analysis += `<p class="alert alert-warn">‚ö° <strong>Mode Snipper :</strong> S√©paration extr√™me pour zones pollu√©es (clous). Vous perdez environ ${(reac*5)}% de profondeur.</p>`;
            } else {
                 analysis += `<p class="alert alert-info">‚öñÔ∏è <strong>Mode √âquilibr√© :</strong> Bon compromis pour la prospection g√©n√©rale.</p>`;
            }
            
            if(notch > 0) {
                 analysis += `<p class="alert alert-info">üéØ <strong>Notch Actif :</strong> Vous rejetez une fen√™tre de cibles. Utile pour les tirettes d'alu, mais risqu√© pour certains bijoux.</p>`;
            }

            document.getElementById('sim-analysis').innerHTML = analysis;
        }

        // --- EXPERT LOGIC ---
        function updateExpert() {
            const r1 = document.getElementById('rng-v1-reac').value;
            const s1 = document.getElementById('rng-v1-sens').value;
            const r2 = document.getElementById('rng-v2-reac').value;
            const s2 = document.getElementById('rng-v2-sens').value;
            const stab = document.getElementById('exp-stab').value;

            document.getElementById('val-v1-reac').textContent = r1;
            document.getElementById('val-v1-sens').textContent = s1;
            document.getElementById('val-v2-reac').textContent = r2;
            document.getElementById('val-v2-sens').textContent = s2;

             // Update Feedback Text for Expert
            function setFb(id, obj) {
                const el = document.getElementById(id);
                el.innerText = obj.text;
                el.className = "param-feedback " + (obj.color === 'warn' ? 'feedback-warn' : 'feedback-good');
            }
            setFb('feed-v1-reac', getFeedback('v1reac', r1));
            setFb('feed-v1-sens', getFeedback('v1sens', s1));
            setFb('feed-v2-reac', getFeedback('v2reac', r2));
            setFb('feed-v2-sens', getFeedback('v2sens', s2));
            setFb('feed-stab', getFeedback('stab', stab));


            let fb = `<div class="result-box">`;
            fb += `<h4 style="color:var(--text-main); margin-bottom:10px;">√âtat du Multi-Processing</h4>`;
            
            const delta = r2 - r1;
            if(delta >= 2.5) {
                fb += `<div class="alert alert-success">‚úÖ <strong>Couverture Totale :</strong> L'√©cart de r√©activit√© est id√©al. V1 attrape le fond, V2 nettoie la surface.</div>`;
            } else if (delta < 1) {
                fb += `<div class="alert alert-warn">‚ö†Ô∏è <strong>Redondance :</strong> Les deux voies sont trop proches. √âcartez les r√©activit√©s pour b√©n√©ficier du V4.</div>`;
            }

            if(stab > 1) {
                fb += `<div style="font-size:0.9rem; color:var(--text-dim); margin-top:5px;">Note: Avec un Stabilizer √† ${stab}, vous sacrifiez un peu de sensibilit√© aux petites cibles (or fin).</div>`;
            }
            fb += `</div>`;
            document.getElementById('expert-feedback').innerHTML = fb;
        }

        // --- SAVE PROFILE LOGIC (PERSISTENCE) ---
        function saveProfile() {
            const name = document.getElementById('profile-name').value;
            if(!name) { alert("Veuillez donner un nom au profil."); return; }

            const profile = {
                id: Date.now(),
                name: name,
                date: new Date().toLocaleDateString(),
                sens: document.getElementById('rng-sens').value,
                reac: document.getElementById('rng-reac').value,
                disc: document.getElementById('rng-disc').value,
                audio: document.getElementById('sel-audio').value,
                expertV1: { r: document.getElementById('rng-v1-reac').value, s: document.getElementById('rng-v1-sens').value },
                expertV2: { r: document.getElementById('rng-v2-reac').value, s: document.getElementById('rng-v2-sens').value }
            };

            let profiles = JSON.parse(localStorage.getItem('deus_profiles')) || [];
            profiles.push(profile);
            localStorage.setItem('deus_profiles', JSON.stringify(profiles));
            document.getElementById('profile-name').value = "";
            renderProfiles();
            alert("Profil sauvegard√© !");
        }

        function renderProfiles() {
            const list = document.getElementById('saved-profiles-list');
            let profiles = JSON.parse(localStorage.getItem('deus_profiles')) || [];
            
            if(profiles.length === 0) {
                list.innerHTML = `<p style="color:var(--text-dim); text-align:center;">Aucun profil sauvegard√©.</p>`;
                return;
            }

            let html = "";
            profiles.forEach((p, index) => {
                html += `
                <div class="saved-item">
                    <div class="saved-item-content">
                        <h4>${p.name}</h4>
                        <p>Sens: ${p.sens} | Reac: ${p.reac} | Disc: ${p.disc} | ${p.audio}</p>
                        <p style="font-size:0.75rem; color:var(--accent-blue);">Expert V4: V1(${p.expertV1.r}) / V2(${p.expertV2.r})</p>
                    </div>
                    <button class="btn btn-danger" onclick="deleteProfile(${index})" style="padding:5px 10px; font-size:0.7rem;">X</button>
                </div>`;
            });
            list.innerHTML = html;
        }

        function deleteProfile(index) {
            let profiles = JSON.parse(localStorage.getItem('deus_profiles')) || [];
            profiles.splice(index, 1);
            localStorage.setItem('deus_profiles', JSON.stringify(profiles));
            renderProfiles();
        }

        // --- LOGBOOK LOGIC ---
        function addLog() {
            const find = document.getElementById('log-find').value;
            const depth = document.getElementById('log-depth').value;
            if(!find) return;

            const log = {
                find: find,
                depth: depth || "?",
                date: new Date().toLocaleDateString()
            };

            let logs = JSON.parse(localStorage.getItem('deus_logs')) || [];
            logs.unshift(log); // Add to top
            localStorage.setItem('deus_logs', JSON.stringify(logs));
            
            document.getElementById('log-find').value = "";
            document.getElementById('log-depth').value = "";
            renderLogs();
        }

        function renderLogs() {
            const list = document.getElementById('logbook-list');
            let logs = JSON.parse(localStorage.getItem('deus_logs')) || [];
            
            if(logs.length === 0) {
                list.innerHTML = `<p style="color:var(--text-dim); text-align:center; font-style:italic;">Carnet vide. Ajoutez votre premi√®re d√©couverte !</p>`;
                return;
            }

            let html = "";
            logs.forEach(l => {
                html += `
                <div style="border-left:2px solid var(--accent-gold); padding-left:10px; margin-bottom:15px;">
                    <div style="color:var(--text-main); font-weight:bold;">${l.find}</div>
                    <div style="color:var(--text-dim); font-size:0.8rem;">Profondeur: ${l.depth}cm ‚Ä¢ ${l.date}</div>
                </div>`;
            });
            list.innerHTML = html;
        }

        // --- FAQ RENDER ---
        function renderFAQ() {
            const c = document.getElementById('faq-container');
            if(c.innerHTML !== "") return;
            
            DATA.faq.forEach(item => {
                c.innerHTML += `
                <div style="background:var(--bg-input); padding:15px; border-radius:6px; margin-bottom:10px; border:1px solid var(--border-light);">
                    <div style="color:var(--accent-blue); font-weight:bold; margin-bottom:5px;">‚ùì ${item.q}</div>
                    <div style="color:var(--text-main); font-size:0.95rem;">${item.a}</div>
                </div>`;
            });
        }

        // INITIALISATION
        updateSim();
        updateExpert();
        renderProfiles();
        renderLogs();

    </script>
</body>
</html>
